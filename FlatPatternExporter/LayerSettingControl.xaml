<UserControl x:Class="FlatPatternExporter.LayerSettingControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:FlatPatternExporter" HorizontalAlignment="Left" FontSize="11">
    <UserControl.Resources>
        <local:ColorToBrushConverter x:Key="ColorToBrushConverter"/>
        <local:LineTypeToGeometryConverter x:Key="LineTypeToGeometryConverter"/>
    </UserControl.Resources>
    <StackPanel Orientation="Horizontal" Margin="0,2,0,2">
        <CheckBox Content="{Binding Pseudonym, RelativeSource={RelativeSource AncestorType=local:LayerSettingControl}}"
          IsChecked="{Binding IsChecked, Mode=TwoWay}"
          Width="180" VerticalContentAlignment="Center"
          IsEnabled="{Binding IsEnabled}"/>
        <Grid Width="95" Margin="0,0,5,0">
            <TextBox x:Name="CustomTextBox"
                     Text="{Binding CustomName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     IsEnabled="{Binding IsCustomNameEnabled}"
                     VerticalContentAlignment="Center"
                     Foreground="Black" Background="White"
                     TextChanged="CustomTextBox_TextChanged"/>
            <TextBlock Text="{Binding LayerName}"
                       Foreground="{StaticResource TextTransparentMutedBrush}"
                       IsHitTestVisible="False"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Left"
                       Margin="5,0,0,0">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Text, ElementName=CustomTextBox}" Value="">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>
        </Grid>
        <ComboBox Width="90"
                  ItemsSource="{Binding DataContext.AvailableColors, RelativeSource={RelativeSource AncestorType=Window}}"
                  SelectedItem="{Binding SelectedColor, Mode=TwoWay}"
                  IsEnabled="{Binding IsColorAndLineTypeEnabled}" VerticalContentAlignment="Center">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <Ellipse Width="16" Height="16"
                                 Fill="{Binding Converter={StaticResource ColorToBrushConverter}}"
                                 Margin="0,0,4,0"/>
                        <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                    </StackPanel>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>
        <ComboBox Width="120"
                  ItemsSource="{Binding DataContext.LineTypes, RelativeSource={RelativeSource AncestorType=Window}}"
                  SelectedItem="{Binding SelectedLineType, Mode=TwoWay}"
                  IsEnabled="{Binding IsColorAndLineTypeEnabled}"
                  Margin="5,0,0,0" VerticalContentAlignment="Center">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Path Grid.Column="0" Stroke="Black" StrokeThickness="1.5"
                              Data="{Binding Converter={StaticResource LineTypeToGeometryConverter}}"
                              Width="50" Height="16" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Grid.Column="1" Text="{Binding}" VerticalAlignment="Center"/>
                    </Grid>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>
        <Button Click="ResetButton_Click"
                CommandParameter="{Binding}"
                IsEnabled="{Binding CanReset}"
                Style="{StaticResource ResetButtonStyle}"
                Margin="5,0,0,0"/>
    </StackPanel>
</UserControl>