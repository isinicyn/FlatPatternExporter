<UserControl x:Class="FlatPatternExporter.LayerSettingControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:FlatPatternExporter" HorizontalAlignment="Left">
    <UserControl.Resources>
        <local:ColorToBrushConverter x:Key="ColorToBrushConverter"/>
        <local:LineTypeToGeometryConverter x:Key="LineTypeToGeometryConverter"/>
        <local:TextEmptyToVisibilityConverter x:Key="TextEmptyToVisibilityConverter"/>
    </UserControl.Resources>
    <StackPanel Orientation="Horizontal" Margin="0,5">
        <CheckBox Content="{Binding Pseudonym, RelativeSource={RelativeSource AncestorType=local:LayerSettingControl}}"
          IsChecked="{Binding IsVisible, Mode=TwoWay}"
          Width="200" VerticalContentAlignment="Center"
          IsEnabled="{Binding IsCheckBoxEnabled}" FontSize="10"/>
        <Grid Width="95" HorizontalAlignment="Right" Margin="0,0,5,0">
            <!-- Текстбокс для пользовательского ввода -->
            <TextBox x:Name="CustomTextBox"
             Text="{Binding CustomName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
             Foreground="Black"
             IsEnabled="{Binding IsCustomNameEnabled}"
             Background="White" FontSize="10" VerticalContentAlignment="Center"
             TextChanged="CustomTextBox_TextChanged"/>

            <!-- Полупрозрачный текстблок для отображения оригинального имени слоя, когда текстбокс пуст -->
            <TextBlock Text="{Binding OriginalName}"
               Foreground="#808E8E8E"
               IsHitTestVisible="False"
               VerticalAlignment="Center"
               HorizontalAlignment="Left"
               Margin="5,0,0,0"
               Visibility="{Binding Text, ElementName=CustomTextBox, Converter={StaticResource TextEmptyToVisibilityConverter}}" FontSize="10"/>
        </Grid>
        <ComboBox Width="90"
                  ItemsSource="{Binding DataContext.AvailableColors, RelativeSource={RelativeSource AncestorType=Window}}"
                  SelectedItem="{Binding SelectedColor, Mode=TwoWay}"
                  IsEnabled="{Binding IsColorAndLineTypeEnabled}" FontSize="10">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <Ellipse Width="16" Height="16"
                                 Fill="{Binding Converter={StaticResource ColorToBrushConverter}}"
                                 Margin="0,0,4,0"/>
                        <TextBlock Text="{Binding}" VerticalAlignment="Center" FontSize="10"/>
                    </StackPanel>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>
        <ComboBox Width="120"
                  ItemsSource="{Binding DataContext.LineTypes, RelativeSource={RelativeSource AncestorType=Window}}"
                  SelectedItem="{Binding SelectedLineType, Mode=TwoWay}"
                  IsEnabled="{Binding IsColorAndLineTypeEnabled}"
                  Margin="5,0,0,0" FontSize="10">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Path Grid.Column="0" Stroke="Black" StrokeThickness="1.5"
                              Data="{Binding Converter={StaticResource LineTypeToGeometryConverter}}"
                              Width="50" Height="16" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Grid.Column="1" Text="{Binding}" VerticalAlignment="Center" FontSize="10"/>
                    </Grid>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>
        <Button Content="✖"
                Foreground="Red"
                FontSize="10"
                FontWeight="Bold"
                Width="22"
                Height="22"
                VerticalAlignment="Center"
                Click="ResetLayerSettings_Click"
                CommandParameter="{Binding}" Margin="5,0,0,0"/>
    </StackPanel>
</UserControl>