<UserControl x:Class="FlatPatternExporter.LayerSettingControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:FlatPatternExporter"
             xmlns:converters="clr-namespace:FlatPatternExporter.Converters"
             HorizontalAlignment="Left">
    <UserControl.Resources>
        <converters:ColorToBrushConverter x:Key="ColorToBrushConverter"/>
        <converters:LineTypeToGeometryConverter x:Key="LineTypeToGeometryConverter"/>
    </UserControl.Resources>
    <StackPanel Orientation="Horizontal" Margin="{StaticResource VerticalTinyMarginThickness}">
        <CheckBox Content="{Binding Pseudonym, RelativeSource={RelativeSource AncestorType=local:LayerSettingControl}}"
          IsChecked="{Binding IsChecked, Mode=TwoWay}"
          Width="180" VerticalContentAlignment="Center"
          IsEnabled="{Binding IsEnabled}"
          Margin="{StaticResource CheckBoxOverrideMarginThickness}"/>
        <Grid Width="95" Margin="{StaticResource RightSmallMarginThickness}">
            <TextBox x:Name="CustomTextBox"
                     Style="{StaticResource BaseTextBoxStyle}"
                     Text="{Binding CustomName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     IsEnabled="{Binding IsCustomNameEnabled}"
                     TextChanged="CustomTextBox_TextChanged"/>
            <TextBlock Text="{Binding LayerName}"
                       Foreground="{StaticResource TextTransparentMutedBrush}"
                       IsHitTestVisible="False"
                       Margin="{StaticResource SmallMarginThickness}"
                       Padding="{StaticResource TextBoxPaddingThickness}"
                       TextTrimming="CharacterEllipsis" VerticalAlignment="Center">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Text, ElementName=CustomTextBox}" Value="">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>
        </Grid>
        <ComboBox Width="90"
                  ItemsSource="{Binding DataContext.AvailableColors, RelativeSource={RelativeSource AncestorType=Window}}"
                  SelectedItem="{Binding SelectedColor, Mode=TwoWay}"
                  IsEnabled="{Binding IsColorAndLineTypeEnabled}" VerticalContentAlignment="Center">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Ellipse Grid.Column="0" Width="16" Height="16"
                                 Fill="{Binding Converter={StaticResource ColorToBrushConverter}}"
                                 Margin="{StaticResource RightTinyPlusMarginThickness}"/>
                        <TextBlock Grid.Column="1" Text="{Binding}" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                    </Grid>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>
        <ComboBox Width="120"
                  ItemsSource="{Binding DataContext.LineTypes, RelativeSource={RelativeSource AncestorType=Window}}"
                  SelectedItem="{Binding SelectedLineType, Mode=TwoWay}"
                  IsEnabled="{Binding IsColorAndLineTypeEnabled}"
                  Margin="{StaticResource LeftSmallMarginThickness}" VerticalContentAlignment="Center">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Path Grid.Column="0" Stroke="{StaticResource TextSecondaryBrush}" StrokeThickness="1.5"
                              Data="{Binding Converter={StaticResource LineTypeToGeometryConverter}}"
                              Width="50" Height="16" VerticalAlignment="Center" Margin="{StaticResource RightTinyPlusMarginThickness}"/>
                        <TextBlock Grid.Column="1" Text="{Binding}" Style="{StaticResource BaseTextBlockStyle}" TextTrimming="CharacterEllipsis"/>
                    </Grid>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>
        <Button Click="ResetButton_Click"
                CommandParameter="{Binding}"
                IsEnabled="{Binding CanReset}"
                Style="{StaticResource ResetButtonStyle}"
                Margin="{StaticResource LeftSmallMarginThickness}"/>
    </StackPanel>
</UserControl>
