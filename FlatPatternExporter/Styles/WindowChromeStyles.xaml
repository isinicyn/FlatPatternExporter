<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework">

    <!-- Window chrome button geometry -->
    <Geometry x:Key="MinimizeIconGeometry">M0,5 L10,5</Geometry>
    <Geometry x:Key="MaximizeIconGeometry">M0,0 L10,0 L10,10 L0,10 Z</Geometry>
    <Geometry x:Key="RestoreIconGeometry">M2,0 L10,0 L10,8 L8,8 M0,2 L0,10 L8,10 L8,8 L2,8 L2,2 Z</Geometry>
    <Geometry x:Key="CloseWindowIconGeometry">M0,0 L10,10 M0,10 L10,0</Geometry>

    <!-- Window chrome button style -->
    <Style x:Key="WindowChromeButtonStyle" TargetType="{x:Type Button}">
        <Setter Property="Width" Value="46"/>
        <Setter Property="Height" Value="32"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border Background="{TemplateBinding Background}"
                            BorderThickness="0">
                        <Path Data="{TemplateBinding Content}"
                              Width="10"
                              Height="10"
                              Stretch="Uniform"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              StrokeThickness="1"
                              Stroke="{TemplateBinding Foreground}"
                              StrokeStartLineCap="Square"
                              StrokeEndLineCap="Square"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="{DynamicResource HoverBackgroundBrush}"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- Close button style -->
    <Style x:Key="WindowChromeCloseButtonStyle" TargetType="{x:Type Button}" BasedOn="{StaticResource WindowChromeButtonStyle}">
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="{DynamicResource ErrorBrush}"/>
                <Setter Property="Foreground" Value="White"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- Custom window style with WindowChrome -->
    <Style x:Key="CustomWindowStyle" TargetType="{x:Type Window}">
        <Setter Property="Background" Value="{DynamicResource BackgroundPrimaryBrush}"/>
        <Setter Property="WindowChrome.WindowChrome">
            <Setter.Value>
                <shell:WindowChrome CaptionHeight="32"
                                    ResizeBorderThickness="5"
                                    CornerRadius="0"
                                    GlassFrameThickness="0"
                                    UseAeroCaptionButtons="False"/>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Window}">
                    <Border Background="{TemplateBinding Background}"
                            BorderBrush="{DynamicResource BorderPrimaryBrush}"
                            BorderThickness="1">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="32"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Title bar -->
                            <Border Grid.Row="0"
                                    Background="{DynamicResource BackgroundSecondaryBrush}"
                                    BorderBrush="{DynamicResource BorderPrimaryBrush}"
                                    BorderThickness="0,0,0,1">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Window icon -->
                                    <Image Grid.Column="0"
                                           Source="{TemplateBinding Icon}"
                                           Width="16"
                                           Height="16"
                                           Margin="10,0,8,0"
                                           VerticalAlignment="Center"
                                           shell:WindowChrome.IsHitTestVisibleInChrome="True"/>

                                    <!-- Window title -->
                                    <TextBlock Grid.Column="1"
                                               Text="{TemplateBinding Title}"
                                               FontSize="{DynamicResource StandardFontSize}"
                                               Foreground="{DynamicResource TextSecondaryBrush}"
                                               VerticalAlignment="Center"
                                               TextTrimming="CharacterEllipsis"/>

                                    <!-- Window buttons -->
                                    <StackPanel Grid.Column="2"
                                                Orientation="Horizontal"
                                                shell:WindowChrome.IsHitTestVisibleInChrome="True">
                                        <Button x:Name="PART_MinimizeButton"
                                                Style="{StaticResource WindowChromeButtonStyle}"
                                                Content="{StaticResource MinimizeIconGeometry}"
                                                ToolTip="Minimize"/>
                                        <Button x:Name="PART_MaximizeRestoreButton"
                                                Style="{StaticResource WindowChromeButtonStyle}"
                                                Content="{StaticResource MaximizeIconGeometry}"
                                                ToolTip="Maximize"/>
                                        <Button x:Name="PART_CloseButton"
                                                Style="{StaticResource WindowChromeCloseButtonStyle}"
                                                Content="{StaticResource CloseWindowIconGeometry}"
                                                ToolTip="Close"/>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- Window content -->
                            <AdornerDecorator Grid.Row="1">
                                <ContentPresenter/>
                            </AdornerDecorator>
                        </Grid>
                    </Border>

                    <!-- Template triggers for window state -->
                    <ControlTemplate.Triggers>
                        <Trigger Property="WindowState" Value="Maximized">
                            <Setter TargetName="PART_MaximizeRestoreButton" Property="Content" Value="{StaticResource RestoreIconGeometry}"/>
                            <Setter TargetName="PART_MaximizeRestoreButton" Property="ToolTip" Value="Restore"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>
